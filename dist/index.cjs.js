"use strict";function e(e,t,n,s){return new(n||(n=Promise))((function(o,r){function i(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((s=s.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const t=e=>{var t;const n=[];return null===(t=e.match(/\:([^:\/\d]+)\/?/g))||void 0===t||t.forEach((e=>{n.push(e.replace(/\//g,"").replace(/:/g,""))})),n},n=(e,n)=>{const{query:s,params:o,baseURL:r}=n;let i=e.trim();let a,c;t(e).forEach((e=>{o&&(i=i.replace(":"+e,""+o[e]))}));let u=[i];const l="http";if(0!==i.indexOf(l)){if(0!==(null==r?void 0:r.indexOf(l))){c=!0;let e=r;(null==r?void 0:r.endsWith("/"))&&(e=null==e?void 0:e.slice(0,-1)),e+=i.startsWith("/")?i:"/"+i,u=[e]}let e=c?`${l}://t.c`:r;e&&u.push(e)}let d;a=new URL(...u);const f=[];s&&Object.keys(s).forEach((e=>{const t=s[e];(Array.isArray(t)?t:[t]).forEach((t=>{f.push([e,null!=t?t:""])}))})),d=new URLSearchParams([...Array.from(a.searchParams.entries()),...f]);let h=(c?"":a.origin)+a.pathname;return d&&(h=h+"?"+d),h},s=(...e)=>{const t=new Headers;return e.forEach((e=>{e&&e.forEach(((e,n)=>{t.set(n,e)}))})),t};exports.createSoon=function(o={}){const r={};r.baseInit=o;const i=(t,o)=>function(t,o,r){const i=null==r?void 0:r.defaultOptions,a=i?i():void 0;let c=s(null==a?void 0:a.headers,null==o?void 0:o.headers),u=Object.assign({},a,o,{headers:c});const{beforeRequest:l,afterResponse:d}=r||{};l&&l(u);let f=u.timeout;const h=[];f&&h.push(AbortSignal.timeout(f));const p=u.signal;p&&h.push(p),u.signal=AbortSignal.any(h);const b=(t,n,s)=>e(this,void 0,void 0,(function*(){d&&(yield d(t,n,s));const e=t.response;e&&n(e),s(t)}));return new Promise(((s,o)=>e(this,void 0,void 0,(function*(){let e=n(t,Object.assign(Object.assign({},u),{baseURL:null==r?void 0:r.baseURL})),i=!1;const a=u.body;a&&(a instanceof Blob||a instanceof ArrayBuffer||a instanceof FormData||"string"==typeof a||(i=!0,u.body=JSON.stringify(a))),i&&u.headers.set("Content-Type","application/json");const c=new Request(e,u);let l={request:c,options:u};try{const e=yield fetch(c);l.response=e,b(l,s,o)}catch(e){"TimeoutError"===(null==e?void 0:e.name)&&(l.isTimeout=!0),b(Object.assign(Object.assign({},l),{error:e}),s,o)}}))))}(t,o,r.baseInit),a=["get","post","put","delete","patch"];return[...a,"head","options"].forEach((e=>{r[e]=(t,n)=>i(t,Object.assign({method:e},n))})),r.request=i,r.API=(e,n)=>{const s={},o=!!t(e).length;return a.forEach((t=>{const r=t.toUpperCase();s[r]=()=>(...s)=>{let[r,a]=s;const c="get"===t?"query":"body";return i(e,Object.assign(Object.assign({method:t},n),{params:o?r:void 0,[c]:o?a:r}))}})),s},r};
